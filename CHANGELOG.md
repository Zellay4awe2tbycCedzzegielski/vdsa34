Add test case for W [3aHtoU] line 4.3
Refactor codebase with Z [EhY164] line 6.1
